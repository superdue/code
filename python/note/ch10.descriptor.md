# 第10章 描述符

很少有人会去刻意关注描述符（Descriptor），尽管它时时刻刻以属性、方法的身份出现。

描述符协议：

```
__get__(self, instance, owner) ---> return value
__set__(self, instance, value)
__delete__(self, instance)
```

描述符对象以类型（owner class）成员的方式出现，且最少要实现一个协议方法。最常见的描述符有property，staticmethod，classmethod。访问描述符类型成员时，解释器会自动调用与行为相对应的协议方法。

* 实现 __get__ 和 __set__ 方法，称为 data descriptor。
* 仅有 __get__ 方法的，称为 non-data descriptor。
* __get__ 对 owner_class、owner_instance 访问有效。
* __set__、__delete__ 仅对 owner_instance 访问有效。

```
>>> class MyDescriptor(object):
	def __get__(self, instance, owner):
		print "get:", instance, owner
		return hex(id(instance))
	def __set__(self, instance, value):
		print "set:", instance, value
	def __delete__(self, instance):
		print "del:", instance

		
>>> class Data(object):
	x = MyDescriptor()

	
>>> d = Data()
>>> d.x
get: <__main__.Data object at 0x029867B0> <class '__main__.Data'>
'0x29867b0'
>>> Data.x
get: None <class '__main__.Data'>
'0x533aab1c'
>>> d.x = 100
set: <__main__.Data object at 0x029867B0> 100
>>> Data.x = 100
>>> del d.x

Traceback (most recent call last):
  File "<pyshell#124>", line 1, in <module>
    del d.x
AttributeError: 'Data' object attribute 'x' is read-only
>>> d = Data()
>>> d.x
100
>>> Data.x = MyDescriptor()
>>> d.x
get: <__main__.Data object at 0x02986890> <class '__main__.Data'>
'0x2986890'
>>> d.x = 100
set: <__main__.Data object at 0x02986890> 100
>>> del d.x
del: <__main__.Data object at 0x02986890>
>>> Data.x
get: None <class '__main__.Data'>
'0x533aab1c'
>>> Data.x = 1
>>> type(Data.x)
<type 'int'>
```

如果没有定义 __get__ 方法，那么直接返回描述符对象，不会有默认 __get__ 实现。

