

客户账户:
中介账户: 是中介方在证券交易组织开设的账户


交易输入系统之后,将经过一系列常规的交易处理流程,其中第一个步骤是`交易充实`.该步骤向交易记录补充一些上游系统没有直接提供的衍生信息.信息包括
交易的现金价值,应缴税费等,不同类型的交易证券还会有其他各式各样的信息.

"对于任何在纽约证券交易所进行的交易,如果基本价值 > 1000 USD,在计算其净现金价值时,应对基本价值进行10%的折扣"

类似的领域规则,我们希望实现成洋葱一样的层叠结构,既可灵活地增减,又不影响核心抽象(请比照装饰器模式来理解)

在执行交易充实步骤之前,首先要验证交易的有效性,而在充实之后,交易还要被登记到会计系统的账簿之中.

在大型DSL脚本里面嵌入小型DSL是相当常见的做法,就以金融交易系统来说,例如处理货币换算,管理日期时间,投资组合报表中管理客户收支结余等场合.
现在假设我们需要为`客户投资组合`报表实现一种DSL,用于报告到给定日期为止,客户账户下持有的各类证券和现金`结余`.

对于熟悉证券交易操作的业内人士来说,客户账户下的结余实际上表示,`客户`在`特定日期按照指定货币计算的现金头寸`.